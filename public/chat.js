document.addEventListener('DOMContentLoaded', () => {
  const chatContainer = document.getElementById('chat-container');
  const timerElement = document.getElementById('session-timer');

  const mainMenu = [
    'ğŸ”‹ ×‘×¢×™×™×ª ×¡×•×œ×œ×”',
    'ğŸ”Œ ×”××œ×’×–×” ×œ× × ×“×œ×§×ª',
    'ğŸ”Š ×¦×¤×¦×•×£ ××•×–×¨',
    'ğŸ’§ × ×–×™×œ×ª ×©××Ÿ',
    'ğŸ› ï¸ ×‘×¢×™×™×ª ×‘×œ××™×',
    'âš™ï¸ ×‘×¢×™×™×ª ×”×™×œ×•×›×™×',
    'ğŸ› ×‘×¢×™×” ×‘×’×œ×’×œ×™×',
    'ğŸ”¥ ×”×ª×—×××•×ª ×× ×•×¢',
    'ğŸ’¡ ×‘×¢×™×™×ª ×ª××•×¨×”',
    'ğŸ§¯ ×‘×¢×™×™×ª ×‘×˜×™×—×•×ª',
    'ğŸ”§ ×¨×¢×™×“×•×ª ×‘×–××Ÿ × ×¡×™×¢×”',
    'ğŸ›¡ï¸ ×‘×¢×™×™×ª ××¢×¨×›×ª ×—×©××œ×™×ª',
    'ğŸ›œ ×‘×¢×™×™×ª ×¡× ×¡×•×¨×™×',
    'ğŸšª ×‘×¢×™×” ×‘×¤×ª×™×—×ª ×“×œ×ª×•×ª',
    'ğŸ§° ×¦×•×¨×š ×‘×˜×™×¤×•×œ ×ª×§×•×¤×ª×™',
    'ğŸ›‘ ×‘×¢×™×™×ª ×—×™×™×©× ×™ ×§×¨×‘×”',
    'ğŸ›¢ï¸ ×‘×¢×™×™×ª ×©××Ÿ ×”×™×“×¨××•×œ×™',
    'ğŸ”‹ ×‘×¢×™×™×ª ×˜×¢×™× ×” ×‘××˜×¢×Ÿ',
    'ğŸ’» ×‘×¢×™×™×ª ×‘×§×¨ ××œ×§×˜×¨×•× ×™'
  ];

  const problemSolutions = {
    'ğŸ”‹ ×‘×¢×™×™×ª ×¡×•×œ×œ×”': ['×‘×“×•×§ ×—×™×‘×•×¨×™× ğŸ”Œ', '××“×•×“ ××ª×— ×¡×•×œ×œ×” ğŸ”‹', '×”×—×œ×£ ×¡×•×œ×œ×” ğŸ”'],
    'ğŸ”Œ ×”××œ×’×–×” ×œ× × ×“×œ×§×ª': ['×‘×“×•×§ ××¤×ª×— ×”×ª× ×¢×” ğŸ”‘', '×‘×“×•×§ ×¤×™×•×–×™× ğŸ”¥', '×‘×“×•×§ ×¡×•×œ×œ×” ğŸ”‹'],
    'ğŸ”Š ×¦×¤×¦×•×£ ××•×–×¨': ['×‘×“×•×§ ××¢×¨×›×ª ×‘×˜×™×—×•×ª ğŸ›¡ï¸', '×‘×“×•×§ ××–×¢×§×” ğŸ””', '×¤× ×” ×œ×‘×“×™×§×” ××§×¦×•×¢×™×ª ğŸ§°'],
    'ğŸ’§ × ×–×™×œ×ª ×©××Ÿ': ['××ª×¨ ××§×•×¨ × ×–×™×œ×” ğŸ’§', '×‘×“×•×§ ×¦×™× ×•×¨×•×ª ×”×™×“×¨××•×œ×™×™× ğŸ› ï¸', '×‘×“×•×§ ××™×›×œ ×©××Ÿ ğŸ”'],
    'ğŸ› ï¸ ×‘×¢×™×™×ª ×‘×œ××™×': ['×‘×“×•×§ ×¨××ª ×©××Ÿ ×‘×œ××™× ğŸ›¢ï¸', '×‘×“×•×§ ×“×™×¡×§×™× ×•×¨×¤×™×“×•×ª ğŸ”©', '×¤× ×” ×œ××•×¡×š ğŸ”§'],
    'âš™ï¸ ×‘×¢×™×™×ª ×”×™×œ×•×›×™×': ['×‘×“×•×§ ×©××Ÿ ×’×™×¨ âš™ï¸', '××ª×—×œ ××¢×¨×›×ª ×”×™×œ×•×›×™× ğŸ”„', '×¤× ×” ×œ×‘×“×™×§×” ××¢××™×§×” ğŸ› ï¸'],
    'ğŸ› ×‘×¢×™×” ×‘×’×œ×’×œ×™×': ['×‘×“×•×§ ×œ×—×¥ ××•×•×™×¨ ğŸ›', '×‘×“×•×§ ×—×™×‘×•×¨×™× ×œ×’×œ×’×œ×™× ğŸ”©', '×”×—×œ×£ ×¦××™×’ ×‘××§×¨×” ×”×¦×•×¨×š ğŸ”'],
    'ğŸ”¥ ×”×ª×—×××•×ª ×× ×•×¢': ['×‘×“×•×§ × ×•×–×œ ×§×™×¨×•×¨ â„ï¸', '×‘×“×•×§ ×××•×•×¨×¨ ×× ×•×¢ ğŸ”¥', '×¢×¦×•×¨ ××™×“ ×œ×”××ª× ×” ğŸ›‘'],
    'ğŸ’¡ ×‘×¢×™×™×ª ×ª××•×¨×”': ['×‘×“×•×§ × ×•×¨×•×ª ğŸ”¦', '×‘×“×•×§ ×¤×™×•×–×™ ×ª××•×¨×” âš¡', '×”×—×œ×£ × ×•×¨×” ×¤×’×•××” ğŸ’¡'],
    'ğŸ§¯ ×‘×¢×™×™×ª ×‘×˜×™×—×•×ª': ['×‘×“×•×§ ×—×™×™×©× ×™ ×‘×˜×™×—×•×ª ğŸ§¯', '×‘×“×•×§ ×‘×œ××™× ğŸ› ï¸', '×¢×¦×•×¨ ×œ×‘×“×™×§×” ××œ××” ğŸ›¡ï¸'],
    'ğŸ”§ ×¨×¢×™×“×•×ª ×‘×–××Ÿ × ×¡×™×¢×”': ['×‘×“×•×§ ××™×–×•×Ÿ ×’×œ×’×œ×™× âš–ï¸', '×‘×“×•×§ ×©×œ××•×ª ×”×¦××™×’×™× ğŸ›', '×¤× ×” ×œ×˜×™×¤×•×œ ×˜×›× ×™ ğŸ”§'],
    'ğŸ›¡ï¸ ×‘×¢×™×™×ª ××¢×¨×›×ª ×—×©××œ×™×ª': ['×‘×“×•×§ ×¤×™×•×–×™× ğŸ”¥', '×‘×“×•×§ ×§×•× ×§×˜×•×¨×™× ×¨×•×¤×¤×™× ğŸ”Œ', '×¤× ×” ×œ×‘×“×™×§×” ××§×¦×•×¢×™×ª ğŸ§°'],
    'ğŸ›œ ×‘×¢×™×™×ª ×¡× ×¡×•×¨×™×': ['×‘×“×•×§ ×ª×§×©×•×¨×ª ×¢× ×¡× ×¡×•×¨×™× ğŸ“¡', '× ×§×” ×¡× ×¡×•×¨×™× ğŸ’¨', '×¤× ×” ×œ×©×™×¨×•×ª ××§×¦×•×¢×™ ğŸ› ï¸'],
    'ğŸšª ×‘×¢×™×” ×‘×¤×ª×™×—×ª ×“×œ×ª×•×ª': ['×‘×“×•×§ ×× ×’× ×•×Ÿ × ×¢×™×œ×” ğŸ”’', '×‘×“×•×§ ×–×¨× ×—×©××œ×™ ×œ×“×œ×ª×•×ª ğŸ”‹', '×©××Ÿ ××ª ×”×× ×¢×•×œ×™× ğŸ›¢ï¸'],
    'ğŸ§° ×¦×•×¨×š ×‘×˜×™×¤×•×œ ×ª×§×•×¤×ª×™': ['×‘×“×•×§ ×¡×¤×¨ ×˜×™×¤×•×œ×™× ğŸ“–', '×¤× ×” ×œ×ª×—×–×•×§×” ×ª×§×•×¤×ª×™×ª ğŸ§°'],
    'ğŸ›‘ ×‘×¢×™×™×ª ×—×™×™×©× ×™ ×§×¨×‘×”': ['× ×§×” ×—×™×™×©× ×™× ğŸ“¡', '×‘×“×•×§ ×—×™×‘×•×¨×™ ×—×™×™×©× ×™× ğŸ”Œ', '×¤× ×” ×œ×©×™×¨×•×ª ××§×¦×•×¢×™ ğŸ”§'],
    'ğŸ›¢ï¸ ×‘×¢×™×™×ª ×©××Ÿ ×”×™×“×¨××•×œ×™': ['×‘×“×•×§ ×¨××•×ª ×©××Ÿ ğŸ›¢ï¸', '×‘×“×•×§ ×“×œ×™×¤×•×ª ×‘××¢×¨×›×ª ğŸ”', '×¤× ×” ×œ×˜×›× ××™ ğŸ§°'],
    'ğŸ”‹ ×‘×¢×™×™×ª ×˜×¢×™× ×” ×‘××˜×¢×Ÿ': ['×‘×“×•×§ ×™×¦×™××ª ×—×©××œ ğŸ”Œ', '×‘×“×•×§ ×›×‘×œ ×˜×¢×™× ×” ğŸ”‹', '× ×¡×” ××˜×¢×Ÿ ××—×¨ ğŸ”„'],
    'ğŸ’» ×‘×¢×™×™×ª ×‘×§×¨ ××œ×§×˜×¨×•× ×™': ['××ª×—×œ ××¢×¨×›×ª ğŸ’»', '×‘×“×•×§ ×—×™×‘×•×¨×™× ×—×©××œ×™×™× ğŸ”Œ', '×¤× ×” ×œ×‘×“×™×§×” ××§×¦×•×¢×™×ª ğŸ› ï¸']
  };

  function showMenu(options, backTo = null) {
    chatContainer.innerHTML = '';
    options.forEach(option => {
      const btn = document.createElement('button');
      btn.className = 'chat-button';
      btn.textContent = option;
      btn.onclick = () => handleOption(option);
      chatContainer.appendChild(btn);
    });
    if (backTo) {
      const backBtn = document.createElement('button');
      backBtn.className = 'chat-button back-button';
      backBtn.textContent = 'ğŸ”™ ×—×–×•×¨';
      backBtn.onclick = () => showMenu(backTo);
      chatContainer.appendChild(backBtn);
    }
  }

  function handleOption(option) {
    if (problemSolutions[option]) {
      showMenu(problemSolutions[option], mainMenu);
    } else {
      chatContainer.innerHTML = `<p>ğŸ§  × ×™×ª×•×— ×”×‘×¢×™×”: ${option}</p>`;
      const backBtn = document.createElement('button');
      backBtn.className = 'chat-button back-button';
      backBtn.textContent = 'ğŸ”™ ×—×–×•×¨';
      backBtn.onclick = () => showMenu(mainMenu);
      chatContainer.appendChild(backBtn);
    }
  }

  showMenu(mainMenu);

  // ×˜×™×™××¨ ×¡×©×Ÿ
  let remainingTime = 60 * 60; // 60 ×“×§×•×ª
  let fiveMinuteWarningShown = false;

  function updateTimer() {
    const minutes = Math.floor(remainingTime / 60);
    const seconds = remainingTime % 60;
    timerElement.textContent = `â³ ×–××Ÿ ×¡×©×Ÿ × ×•×ª×¨: ${minutes}:${seconds.toString().padStart(2, '0')}`;
    remainingTime--;

    if (remainingTime === 5 * 60 && !fiveMinuteWarningShown) {
      alert("â° × ×•×ª×¨×• ×¨×§ 5 ×“×§×•×ª ×œ×¡×™×•× ×”×¡×©×Ÿ ×©×œ×š!");
      fiveMinuteWarningShown = true;
    }

    if (remainingTime < 0) {
      window.location.href = "expired.html";
    }
  }

  setInterval(updateTimer, 1000);
});
